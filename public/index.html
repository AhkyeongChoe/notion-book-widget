<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  < title>Notion Book Widget</title>
</head>
<body>
  <h2>ğŸ“š ì±… ê²€ìƒ‰</h2>

  <input id="query" placeholder="ì±… ì œëª© ì…ë ¥" />
  <button onclick="search()">ê²€ìƒ‰</button>

  <div id="result"></div>

  <script>
    async function search() {
      const q = document.getElementById("query").value;
      const res = await fetch(
        `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(q)}`
      );
      const data = await res.json();
      const book = data.items[0].volumeInfo;

      document.getElementById("result").innerHTML = `
        <h3>${book.title}</h3>
        <p>${book.authors?.join(", ")}</p>
        <img src="${book.imageLinks?.thumbnail}" />
        <br/>
        <button onclick='addBook(${JSON.stringify(book)})'>
          ë…¸ì…˜ì— ì¶”ê°€
        </button>
      `;
    }

    async function addBook(book) {
      await fetch("/api/addBook", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(book)
      });
      alert("ë…¸ì…˜ì— ì¶”ê°€ë¨!");
    }
  </script>

  <small>Powered by Google Books</small>
</body>
</html>
